MAIN	START	1000

FIRST	JSUB	STKINIT

	LDX	#0
ASEN	WORD	10
	JSUB	RLOOP
	LDX	#0

TOSTK	LDA	INPUT,X
	STA	@TOP
	JSUB	PUSH
	TIX	LEN
	JLT	TOSTK

	LDX	#0
COPY	JSUB	POP
	LDA	@TOP
	STA	RESULT,X
	TIX	LEN
	JLT	COPY

	LDX	#0
	JSUB	WLOOP

STOP	J	STOP

RLOOP	TD	INDEV
	JEQ	RLOOP
	RD	INDEV
	COMP	ASEN
	JEQ	RDEXIT
	STCH	INPUT,X
	TIX	#20
	JLT	RLOOP
	RSUB

RDEXIT	STX	LEN
	RSUB

WLOOP	TD	OUTDEV
	JEQ	WLOOP
	LDCH	RESULT,X
	WD	OUTDEV
	TIX	LEN
	JLT	WLOOP
	RSUB



STKINIT	LDA	#STACK
	STA	TOP
	RSUB

PUSH	LDA	TOP
	ADD	#3
	STA	TOP
	RSUB

POP	LDA	TOP
	SUB	#3
	STA	TOP
	RSUB

INDEV	BYTE	0
OUTDEV	BYTE	1
INPUT	RESW	21
RESULT	RESW	21
LEN	RESW	1
TOP	RESW	1
STACK	RESW	100
